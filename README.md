# Speed difference test between Express, Hapi, HTTP, Polka, Restana, Restify, find-my-way (spoiler: Restana destroys all of them)

## Method: 
Running each server, that need to listen at 3000 and send `"Hello world"` to `"/"` route. 

Then running autocannon package with 200 active connections to test latency and rps count.

Server: Mi notebook Air 13.3 2018 (i7, 8/256)

## Tables with tests result (Avg column is main for us)

### Express
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬───────┬───────┬───────┬───────┬──────────┬────────┬────────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev  │ Max        │
├─────────┼───────┼───────┼───────┼───────┼──────────┼────────┼────────────┤
│ Latency │ 10 ms │ 12 ms │ 23 ms │ 27 ms │ 13.19 ms │ 9.2 ms │ 1083.74 ms │
└─────────┴───────┴───────┴───────┴───────┴──────────┴────────┴────────────┘
┌───────────┬─────────┬─────────┬─────────┬────────┬──────────┬────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%  │ Avg      │ Stdev  │ Min     │
├───────────┼─────────┼─────────┼─────────┼────────┼──────────┼────────┼─────────┤
│ Req/Sec   │ 8967    │ 8967    │ 16095   │ 17135  │ 14591.64 │ 2523.8 │ 8964    │
├───────────┼─────────┼─────────┼─────────┼────────┼──────────┼────────┼─────────┤
│ Bytes/Sec │ 1.94 MB │ 1.94 MB │ 3.48 MB │ 3.7 MB │ 3.15 MB  │ 546 kB │ 1.94 MB │
└───────────┴─────────┴─────────┴─────────┴────────┴──────────┴────────┴─────────┘

Req/Bytes counts sampled once per second.

161k requests in 11.09s, 34.7 MB read
```
### Hapi
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬───────┬───────┬───────┬───────┬──────────┬──────────┬───────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev    │ Max       │
├─────────┼───────┼───────┼───────┼───────┼──────────┼──────────┼───────────┤
│ Latency │ 11 ms │ 12 ms │ 19 ms │ 29 ms │ 12.73 ms │ 14.14 ms │ 1049.3 ms │
└─────────┴───────┴───────┴───────┴───────┴──────────┴──────────┴───────────┘
┌───────────┬────────┬────────┬─────────┬─────────┬──────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%     │ 97.5%   │ Avg      │ Stdev   │ Min    │
├───────────┼────────┼────────┼─────────┼─────────┼──────────┼─────────┼────────┤
│ Req/Sec   │ 7563   │ 7563   │ 15999   │ 16351   │ 15120.19 │ 2440.52 │ 7562   │
├───────────┼────────┼────────┼─────────┼─────────┼──────────┼─────────┼────────┤
│ Bytes/Sec │ 1.5 MB │ 1.5 MB │ 3.17 MB │ 3.24 MB │ 2.99 MB  │ 483 kB  │ 1.5 MB │
└───────────┴────────┴────────┴─────────┴─────────┴──────────┴─────────┴────────┘

Req/Bytes counts sampled once per second.

166k requests in 11.09s, 32.9 MB read
```
### HTTP
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬──────┬──────┬───────┬───────┬─────────┬──────────┬────────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev    │ Max        │
├─────────┼──────┼──────┼───────┼───────┼─────────┼──────────┼────────────┤
│ Latency │ 3 ms │ 5 ms │ 11 ms │ 13 ms │ 5.53 ms │ 10.57 ms │ 1045.55 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴──────────┴────────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 21743   │ 21743   │ 31391   │ 40095   │ 33141.6 │ 6367.14 │ 21728   │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 2.41 MB │ 2.41 MB │ 3.49 MB │ 4.45 MB │ 3.68 MB │ 707 kB  │ 2.41 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.

331k requests in 10.11s, 36.8 MB read
```
### Polka
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬──────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max      │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼──────────┤
│ Latency │ 4 ms │ 4 ms │ 7 ms  │ 9 ms │ 4.48 ms │ 2.17 ms │ 96.79 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴──────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┼─────────┤
│ Req/Sec   │ 32191   │ 32191   │ 40799   │ 42815   │ 39859.64 │ 2714.38 │ 32181   │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┼─────────┤
│ Bytes/Sec │ 3.57 MB │ 3.57 MB │ 4.53 MB │ 4.75 MB │ 4.42 MB  │ 301 kB  │ 3.57 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.

438k requests in 11.09s, 48.7 MB read
```
### Restana
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬────────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max        │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼────────────┤
│ Latency │ 2 ms │ 3 ms │ 7 ms  │ 9 ms │ 3.48 ms │ 7.42 ms │ 1044.34 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴────────────┘
┌───────────┬───────┬───────┬─────────┬─────────┬─────────┬─────────┬───────┐
│ Stat      │ 1%    │ 2.5%  │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min   │
├───────────┼───────┼───────┼─────────┼─────────┼─────────┼─────────┼───────┤
│ Req/Sec   │ 35743 │ 35743 │ 51423   │ 53375   │ 50188.8 │ 4933.04 │ 35734 │
├───────────┼───────┼───────┼─────────┼─────────┼─────────┼─────────┼───────┤
│ Bytes/Sec │ 4 MB  │ 4 MB  │ 5.76 MB │ 5.98 MB │ 5.62 MB │ 552 kB  │ 4 MB  │
└───────────┴───────┴───────┴─────────┴─────────┴─────────┴─────────┴───────┘

Req/Bytes counts sampled once per second.

502k requests in 10.1s, 56.2 MB read
```
### Restify
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬──────┬──────┬───────┬───────┬─────────┬─────────┬────────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev   │ Max        │
├─────────┼──────┼──────┼───────┼───────┼─────────┼─────────┼────────────┤
│ Latency │ 7 ms │ 8 ms │ 13 ms │ 18 ms │ 8.64 ms │ 8.49 ms │ 1057.68 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴─────────┴────────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev  │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼────────┼─────────┤
│ Req/Sec   │ 11543   │ 11543   │ 23231   │ 23615   │ 22014.91 │ 3350.1 │ 11540   │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼────────┼─────────┤
│ Bytes/Sec │ 1.87 MB │ 1.87 MB │ 3.76 MB │ 3.82 MB │ 3.57 MB  │ 543 kB │ 1.87 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴────────┴─────────┘

Req/Bytes counts sampled once per second.

242k requests in 11.08s, 39.2 MB read
```
### find-my-way
```
botkooper@xiaomi:~/servers-testing$ autocannon -c 200 localhost:3000
Running 10s test @ http://localhost:3000
200 connections

┌─────────┬──────┬──────┬───────┬───────┬─────────┬─────────┬────────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev   │ Max        │
├─────────┼──────┼──────┼───────┼───────┼─────────┼─────────┼────────────┤
│ Latency │ 3 ms │ 4 ms │ 10 ms │ 11 ms │ 4.97 ms │ 6.74 ms │ 1041.81 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴─────────┴────────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 27583   │ 27583   │ 38623   │ 45727   │ 37016   │ 5804.04 │ 27576   │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 3.06 MB │ 3.06 MB │ 4.29 MB │ 5.07 MB │ 4.11 MB │ 644 kB  │ 3.06 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.

407k requests in 11.08s, 45.2 MB read
```
## Summary

### Spelled answer

Libraries in speed order (faster to slowest):

Restana => Polka => find-my-way => HTTP => Restify => Hapi => Express

### Table diff answer

Metrica \ Library | Restana | Polka | find-my-way |HTTP | Restify | Hapi | Express | 
--- | --- |--- | --- |--- | --- | ---| ---
Avg latency (ms) | **3.48** | 4.48 | 6.74 | 5.53 | 8.64 | 12.73 | 13.19
Avg req/sec | **50188** | 39859 | 37016 | 33141 | 22014 | 15120 | 14591
Avg bytes/sec | **5.62 MB** | 4.42 MB | 4.11 MB | 3.68 MB |3.57 MB | 2.99 MB | 3.15 MB
